/* =============================================
 * Kev's Bitchin' Print Calculator — style.css
 * ---------------------------------------------
 * Purpose: A lean, production-focused dark UI
 * with a simplified, print-accurate measurement
 * palette and consistent tokens.
 *
 * Notes:
 * - Colors align with common prepress conventions.
 * - Slits/Perforations share the SCORE channel
 *   (differentiate via line styles, not color).
 * - All previously undefined tokens are resolved.
 * - Includes accessibility and print polish.
 * ============================================= */

/* =============================================
 * Root Theme Tokens
 * ---------------------------------------------
 * Single source of truth for colors, spacing,
 * typography, and interaction states.
 * ============================================= */
:root {
  /* -------------------------------------------------------
     SURFACE — condensed hierarchy for dark UI
     Keep this minimal: background, panel, overlay, control.
  ------------------------------------------------------- */
  --surface-bg: #0f1115;            /* main background */
  --surface-panel: #171a21;         /* panels, cards */
  --surface-overlay: #11141b;       /* hover/overlay shells */
  --surface-control: #1a1f2a;       /* inputs and buttons */

  /* Derived/legacy surface aliases (used by components) */
  --surface-panel-elevated: var(--surface-panel);
  --surface-panel-overlay: var(--surface-overlay);
  --surface-card: var(--surface-panel);
  --surface-inset: color-mix(in srgb, var(--surface-panel) 80%, var(--surface-bg) 20%);
  --surface-paper: #fff;            /* print background */

  /* -------------------------------------------------------
     BORDER — simplified and practical
     One default, one strong, one accent. Others are aliases.
  ------------------------------------------------------- */
  --border-default: #222632;        /* general border */
  --border-strong: #2c3446;         /* active/selected */
  --border-accent: #1f8a8a;         /* accent / highlight */

  /* Derived/legacy border aliases (keep old selectors working) */
  --border-subtle: color-mix(in srgb, var(--border-default) 70%, transparent);
  --border-muted: var(--border-default);
  --border-highlight: var(--border-accent);
  --border-card: var(--border-default);
  --border-overlay: var(--border-default);
  --border-dashed: color-mix(in srgb, var(--border-default) 85%, transparent);

  /* -------------------------------------------------------
     TEXT — clear hierarchy
  ------------------------------------------------------- */
  --text-primary: #e6e9ef;          /* main text */
  --text-secondary: #b8c0cc;        /* secondary text */
  --text-muted: #8892a6;            /* subdued labels */
  --text-bright: #e2e8f0;           /* used on selected/hover rows */
  --text-inverse: #000;             /* light-on-paper */

  /* -------------------------------------------------------
     NAVIGATION — derived, consistent
     Use the text/border tokens above.
  ------------------------------------------------------- */
  --nav-text-muted: var(--text-secondary);
  --nav-text-hover: var(--accent-primary);
  --nav-text-active: var(--text-primary);
  --nav-border: var(--border-default);
  --nav-border-active: var(--accent-primary);

  /* -------------------------------------------------------
     ACCENT & STATUS — primary feedback colors
  ------------------------------------------------------- */
  --accent-primary: #5eead4;        /* highlight / focus */
  --status-danger: #ef4444;         /* error / delete */
  --status-success: #22c55e;        /* success */
  --status-warning: #f59e0b;        /* warning */

  /* -------------------------------------------------------
     MEASUREMENT — print-proof standards
     Reduced to five semantic channels.
  ------------------------------------------------------- */
  --measure-layout: #00AEEF;        /* Cyan — sheet outline */
  --measure-document: #00B050;      /* Green — doc bounds */
  --measure-margin: #FFA500;        /* Orange — safe area */
  --measure-cut: #FF0000;           /* Red — trim/die */
  --measure-score: #800080;         /* Purple — fold/perf/slit (merged) */
  --measure-hole: #2563eb;          /* Blue — drilling */

  /* Line styles for extra differentiation (esp. grayscale proofs) */
  --line-cut-style: solid;          /* solid red = cut */
  --line-score-style: dashed;       /* dashed purple = fold */
  --line-perf-style: dotted;        /* dotted purple = perforation */
  --line-margin-style: dashed;      /* dashed orange = margin */
  --line-layout-style: solid;       /* thin cyan = layout */

  /* Hover/selection fills (tables) */
  --measure-cut-bg-hover: color-mix(in srgb, var(--measure-cut) 15%, transparent);
  --measure-cut-bg-selected: color-mix(in srgb, var(--measure-cut) 25%, transparent);
  --measure-score-bg-hover: color-mix(in srgb, var(--measure-score) 15%, transparent);
  --measure-score-bg-selected: color-mix(in srgb, var(--measure-score) 25%, transparent);
  --measure-hole-bg-hover: color-mix(in srgb, var(--measure-hole) 15%, transparent);
  --measure-hole-bg-selected: color-mix(in srgb, var(--measure-hole) 25%, transparent);

  /* Line glow colors (preview) */
  --measure-cut-glow: #ff6666;        /* light red highlight */
  --measure-score-glow: #c4b5fd;      /* lavender highlight */
  --measure-cut-glow-soft: color-mix(in srgb, var(--measure-cut-glow) 60%, transparent);
  --measure-score-glow-soft: color-mix(in srgb, var(--measure-score-glow) 60%, transparent);
  --measure-hole-glow: #93c5fd;       /* light blue highlight */
  --measure-hole-glow-soft: color-mix(in srgb, var(--measure-hole-glow) 60%, transparent);

  /* -------------------------------------------------------
     Shadows
  ------------------------------------------------------- */
  --shadow-elevated: color-mix(in srgb, var(--surface-bg) 65%, transparent);
  --shadow-deep: color-mix(in srgb, var(--text-inverse) 25%, transparent);

  /* -------------------------------------------------------
     Spacing scales
  ------------------------------------------------------- */
  --stack-gap-default: 12px;
  --stack-gap-tight: 8px;
  --stack-gap-snug: 6px;
  --stack-gap-comfortable: 16px;
  --stack-gap-spacious: 18px;

  --grid-gap-default: 12px;
  --grid-gap-tight: 8px;
  --grid-gap-snug: 6px;
  --grid-gap-comfortable: 16px;
  --grid-gap-spacious: 18px;

  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;

  /* -------------------------------------------------------
     Type scale
  ------------------------------------------------------- */
  --font-xs: 0.8rem;
  --font-sm: 0.9rem;

  /* -------------------------------------------------------
     Legacy aliases (do not remove; keep old code alive)
  ------------------------------------------------------- */
  --bg: var(--surface-bg);
  --panel: var(--surface-panel);
  --muted: var(--text-muted);
  --text: var(--text-primary);
  --accent: var(--accent-primary);
  --danger: var(--status-danger);
  --ok: var(--status-success);
  --warn: var(--status-warning);

  /* -------------------------------------------------------
     Control hover color
  ------------------------------------------------------- */
  --surface-control-hover: color-mix(in srgb, var(--surface-control) 85%, var(--text-inverse) 15%);
}

/* =============================================
 * Global Resets & Base Typography
 * ============================================= */
* { box-sizing: border-box; }

html, body { height: 100%; }

body {
  margin: 0;
  background: var(--surface-bg);
  color: var(--text-primary);
  font: 14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

h1, h2, h3 { margin: 0 0 0.5rem; }

h1 { font-size: 1.25rem; }
h2 { font-size: 1.05rem; color: var(--text-secondary); }
h3 { font-size: 0.95rem; color: var(--text-secondary); }

/* =============================================
 * Layout Utilities
 * ---------------------------------------------
 * Flex stack + grid helpers keep the markup light.
 * ============================================= */
.stack {
  display: flex;
  flex-direction: column;
  gap: var(--stack-gap, var(--stack-gap-default));
}
.stack--compact   { --stack-gap: var(--stack-gap-tight); }
.stack--snug      { --stack-gap: var(--stack-gap-snug); }
.stack--roomy     { --stack-gap: var(--stack-gap-comfortable); }
.stack--spacious  { --stack-gap: var(--stack-gap-spacious); }

.grid {
  display: grid;
  gap: var(--grid-gap, var(--grid-gap-default));
}
.grid--compact    { --grid-gap: var(--grid-gap-tight); }
.grid--snug       { --grid-gap: var(--grid-gap-snug); }
.grid--roomy      { --grid-gap: var(--grid-gap-comfortable); }
.grid--spacious   { --grid-gap: var(--grid-gap-spacious); }
.grid--auto-fit   { grid-template-columns: repeat(auto-fit, minmax(var(--grid-min, 240px), 1fr)); }
.grid--auto-fill  { grid-template-columns: repeat(auto-fill, minmax(var(--grid-min, 150px), 1fr)); }
.grid--columns-2  { grid-template-columns: repeat(2, minmax(0, 1fr)); }

/* =============================================
 * App Shell
 * ============================================= */
.layout-app-shell {
  max-width: 1280px;
  margin: 0 auto;
  padding: 16px 18px 24px;
  min-height: 100vh;
  --stack-gap: var(--stack-gap-spacious);
}

.layout-app-header {
  padding: 4px 6px 0;
  --stack-gap: 4px;
}
.layout-app-header p {
  margin: 0;
  max-width: 640px;
}

/* Remove extra space when toolbars are inside stacks */
.stack .control-toolbar,
.stack .visualizer-visibility-toggles { margin: 0; }

/* =============================================
 * Inputs Pane (scrollable)
 * ============================================= */
.input-scroll-container {
  flex: 1;
  min-height: 0;
  --stack-gap: 16px;
  overflow-y: auto;
  padding-right: 6px;
}

/* Sticky unit selector at top of scroll */
.input-unit-controls {
  position: sticky;
  top: 0;
  padding: 6px 0 10px;
  background: var(--surface-panel);
  z-index: 1;
  box-shadow: 0 6px 12px var(--shadow-elevated);
  margin: 0;
}
/* Separator line under sticky header */
.input-unit-controls::after {
  content: "";
  position: absolute;
  inset: auto 0 0;
  height: 1px;
  background: var(--border-default);
  opacity: 0.6;
}

/* Content sections (cards) */
.content-section {
  background: var(--surface-panel);
  border: 1px solid var(--border-default);
  border-radius: 14px;
  padding: 14px;
  box-shadow: 0 4px 24px var(--shadow-deep);
}

/* Preview + output sections */
.sheet-preview-visualizer { --stack-gap: 12px; }
.output-details-section   { --stack-gap: 0; }

.output-details-section .output-tabpanel-collection {
  flex: 1;
  min-height: 0;
}

.input-layout-panel { --stack-gap: 16px; }

.input-panel-header p {
  margin: 0;
  font-size: 0.95rem;
}

/* =============================================
 * Inputs Grid (dense two-column)
 * ============================================= */
.input-2col-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-4);
  align-items: start;
}
.input-2col-grid .col-left,
.input-2col-grid .col-right {
  display: grid;
  gap: var(--space-4);
  align-content: start;
}
.input-2col-grid .group {
  display: grid;
  grid-template-rows: auto auto;
  row-gap: var(--space-2);
  padding: 0;
  border: 0;
  background: transparent;
}
.input-2col-grid .group > h2 {
  font-size: var(--font-sm);
  font-weight: 600;
  margin: 0 0 var(--space-1);
  opacity: 0.9;
}
.input-2col-grid .control-toolbar { margin: 0; }

/* Input field rows */
.input-field-row,
.input-field-row-quad {
  display: grid;
  gap: var(--space-2);
}
.input-field-row { grid-template-columns: repeat(2, minmax(0, 1fr)); }
.input-field-row.with-action {
  grid-template-columns: repeat(2, minmax(0, 1fr)) auto;
  align-items: end;
}
.input-field-action {
  display: flex;
  align-items: center;
  justify-content: center;
}
.input-swap-button {
  --swap-size: 32px;
  inline-size: var(--swap-size);
  block-size: var(--swap-size);
  border-radius: 999px;
  border: 1px solid var(--border-subtle);
  background: var(--surface-control);
  color: var(--text-primary);
  font-size: 1rem;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
}
.input-swap-button:hover,
.input-swap-button:focus {
  background: var(--surface-control-hover);
  border-color: var(--accent-primary);
  color: var(--text-primary);
  outline: none;
}
.input-swap-button:focus-visible {
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-primary) 40%, transparent);
}
.input-field-row-quad { grid-template-columns: repeat(4, minmax(0, 1fr)); }

/* Auto grid helper (breaks to fit) */
.input-field-row-auto {
  --grid-gap: var(--grid-gap-snug);
  --grid-min: 150px;
}

/* =============================================
 * Responsive tweaks
 * ============================================= */
@media (max-width: 1024px) {
  .input-2col-grid { grid-template-columns: 1fr; }
  .input-2col-grid .col-left,
  .input-2col-grid .col-right { gap: var(--space-3); }
  .input-field-row-quad { grid-template-columns: repeat(2, minmax(0, 1fr)); }
}
@media (max-width: 600px) {
  .input-field-row { grid-template-columns: 1fr 1fr; }
  .input-field-row-quad { grid-template-columns: 1fr 1fr; }
  .input-field-row.with-action { grid-template-columns: 1fr 1fr; }
  .input-field-row.with-action .input-field-action {
    grid-column: 1 / -1;
    justify-content: flex-end;
  }
}
@media (max-width: 900px) {
  .input-scroll-container { overflow: visible; padding-right: 0; }
  .input-unit-controls { position: static; box-shadow: none; }
  .input-unit-controls::after { display: none; }
  .sheet-preview-layout { flex-direction: column; }
  .layer-visibility-panel { width: 100%; max-width: none; }
}

/* =============================================
 * Typography Helpers
 * ============================================= */
.text-muted-detail { color: var(--text-muted); }
.text-metric-readout { font-variant-numeric: tabular-nums; }

/* =============================================
 * Form Elements
 * ============================================= */
label {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
  padding: 4px 6px;
  background: transparent;
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
}
label span {
  color: var(--text-muted);
  font-size: 0.9rem;
}
label input {
  all: unset;
  background: var(--surface-panel-elevated);
  border: 1px solid var(--border-strong);
  padding: 6px 8px;
  border-radius: 8px;
  width: 96px;
  color: var(--text-primary);
  text-align: right;
}
select {
  background: var(--surface-panel-elevated);
  border: 1px solid var(--border-strong);
  padding: 6px 8px;
  border-radius: 8px;
  color: var(--text-primary);
  width: 100%;
}

/* Dense layout tune-up for labels/inputs */
.input-2col-grid label {
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  gap: var(--space-1);
  padding: var(--space-1) var(--space-2);
}
.input-2col-grid label > span {
  font-size: var(--font-xs);
  opacity: 0.85;
  color: var(--text-muted);
}
.input-2col-grid input,
.input-2col-grid select {
  height: 2rem;
  padding: 0 var(--space-2);
  font-size: var(--font-sm);
  line-height: 2rem;
  width: 100%;
}
.input-2col-grid input { text-align: right; }

.input-2col-grid input.is-invalid,
.input-2col-grid select.is-invalid {
  box-shadow: 0 0 0 1px var(--status-danger);
  background: color-mix(in srgb, var(--status-danger) 12%, transparent);
}

/* =============================================
 * Control Toolbars
 * ============================================= */
.control-toolbar {
  display: flex;
  gap: var(--space-2);
  align-items: center;
  flex-wrap: wrap;
  margin: 0.5rem 0 0;
}
.data-card > .control-toolbar { margin: 0 0 6px; }
.preset-selector-toolbar { justify-content: flex-start; }
.input-action-toolbar { justify-content: space-between; gap: 12px; }

/* =============================================
 * Preview Controls (layer visibility)
 * ============================================= */
.visualizer-visibility-toggles {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
  margin: 0;
}

/* =============================================
 * Buttons
 * ============================================= */
.action-button {
  appearance: none;
  border: 1px solid var(--border-muted);
  background: var(--surface-control);
  color: var(--text-primary);
  padding: 8px 10px;
  border-radius: 10px;
  cursor: pointer;
}
.action-button:hover {
  border-color: var(--border-highlight);
  background: var(--surface-inset);
}
.action-button-primary {
  border-color: var(--border-accent);
  background: var(--surface-control);
}
.action-button-ghost { background: transparent; }
.action-button.is-active {
  border-color: var(--accent-primary);
  background: color-mix(in srgb, var(--accent-primary) 16%, var(--surface-control));
  color: var(--accent-primary);
}
.action-button:focus-visible {
  outline: 2px solid var(--accent-primary);
  outline-offset: 2px;
}

/* =============================================
 * Navigation (tabs/segmented)
 * ============================================= */
.nav-bar {
  display: flex;
  align-items: stretch;
  gap: var(--nav-gap, 8px);
  padding: var(--nav-padding, 0);
  border-bottom: var(--nav-border-size, 0px) solid var(--nav-border-color, transparent);
}
.nav-bar--tabs {
  --nav-gap: 6px;
  --nav-padding: 0 10px;
  --nav-border-size: 1px;
  --nav-border-color: var(--nav-border);
}
.nav-trigger {
  appearance: none;
  background: none;
  border: none;
  border-bottom: var(--nav-trigger-border-width, 2px) solid transparent;
  color: var(--nav-text-muted);
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  font: inherit;
  font-weight: 500;
  gap: 6px;
  line-height: 1.2;
  padding: var(--nav-trigger-padding, 8px 12px);
  transition: color 0.18s ease, border-color 0.18s ease;
}
.nav-trigger--tab {
  --nav-trigger-padding: 10px 12px;
  --nav-trigger-border-width: 2px;
}
.nav-trigger:hover { color: var(--nav-text-hover); }
.nav-trigger:focus-visible {
  outline: 2px solid var(--border-highlight);
  outline-offset: 2px;
}
.nav-trigger.is-active {
  color: var(--nav-text-active);
  border-bottom-color: var(--nav-border-active);
}

/* =============================================
 * Tabs & Cards (output area)
 * ============================================= */
.output-tab-navigation { margin: 0 -14px 10px; }
.output-tabpanel-collection > section { display: none; }
.output-tabpanel-collection > section.is-active { display: block; }

.summary-metrics-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
}

.data-card {
  background: var(--surface-card);
  border: 1px solid var(--border-card);
  border-radius: 12px;
  padding: 12px;
}
.data-card .summary-metric-value {
  font-variant-numeric: tabular-nums;
  font-weight: 600;
}

.summary-card__title {
  margin: 0 0 8px;
  font-size: 1.05rem;
}

.summary-card__metrics {
  margin: 0;
  display: grid;
  gap: 6px;
}

.summary-card__metrics > div {
  display: flex;
  justify-content: space-between;
  gap: 12px;
}

.summary-card__metrics dt {
  margin: 0;
  font-weight: 500;
  color: var(--text-secondary);
}

.summary-card__metrics dd {
  margin: 0;
  text-align: right;
}

.summary-calculator-section {
  margin-top: 24px;
  display: flex;
  flex-direction: column;
  gap: 18px;
}

.summary-calculator-grid {
  display: grid;
  gap: 16px;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
}

.summary-calculator__header {
  margin-bottom: 12px;
}

.summary-calculator__title {
  margin: 0 0 4px;
  font-size: 1.1rem;
}

.summary-calculator__description {
  margin: 0;
  color: var(--text-secondary);
  font-size: 0.9rem;
}

.summary-calculator__form {
  display: grid;
  gap: 12px;
  margin-bottom: 14px;
}

.summary-calculator__field {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.summary-calculator__label {
  font-weight: 600;
}

.summary-calculator__field input {
  width: 100%;
}

.summary-calculator__hint {
  font-size: 0.8rem;
  color: var(--text-tertiary);
}

.summary-calculator__results {
  margin: 0;
  display: grid;
  gap: 8px;
}

.summary-calculator__results > div {
  display: flex;
  justify-content: space-between;
  gap: 12px;
}

.summary-calculator__results dt {
  margin: 0;
  font-weight: 500;
  color: var(--text-secondary);
}

.summary-calculator__results dd {
  margin: 0;
  font-weight: 600;
  text-align: right;
  font-variant-numeric: tabular-nums;
}

.data-table { width: 100%; border-collapse: collapse; }
.data-table th, .data-table td {
  padding: 8px 10px;
  border-bottom: 1px dashed var(--border-dashed);
}
.data-table th {
  text-align: left;
  color: var(--text-secondary);
}

/* =============================================
 * Measurements (table ↔ preview linkage)
 * ============================================= */
.measurement-row {
  cursor: pointer;
  transition: background 0.18s ease, color 0.18s ease;
}
.measurement-row:focus {
  outline: 1px solid var(--accent-primary);
  outline-offset: -2px;
}
.measurement-row.is-hovered,
.measurement-row.is-selected { color: var(--text-bright); }

/* Cut (and slit, if you decide to split later) */
.measurement-row[data-measure-type="cut"].is-hovered,
.measurement-row[data-measure-type="cut"].is-selected {
  background: var(--measure-cut-bg-hover);
}
.measurement-row[data-measure-type="cut"].is-selected {
  background: var(--measure-cut-bg-selected);
}

/* Score + slit + perforation share SCORE channel */
.measurement-row[data-measure-type="score-horizontal"].is-hovered,
.measurement-row[data-measure-type="score-vertical"].is-hovered,
.measurement-row[data-measure-type="perforation"].is-hovered,
.measurement-row[data-measure-type="slit"].is-hovered {
  background: var(--measure-score-bg-hover);
}
.measurement-row[data-measure-type="score-horizontal"].is-selected,
.measurement-row[data-measure-type="score-vertical"].is-selected,
.measurement-row[data-measure-type="perforation"].is-selected,
.measurement-row[data-measure-type="slit"].is-selected {
  background: var(--measure-score-bg-selected);
}

.measurement-row[data-measure-type="hole"].is-hovered,
.measurement-row[data-measure-type="hole"].is-selected {
  background: var(--measure-hole-bg-hover);
}

.measurement-row[data-measure-type="hole"].is-selected {
  background: var(--measure-hole-bg-selected);
}

/* Preview lines */
.measurement-line {
  pointer-events: auto;
  transition: stroke 0.2s ease, stroke-width 0.2s ease, opacity 0.2s ease;
  opacity: 0.9;
}
.measurement-line.is-hovered,
.measurement-line.is-selected {
  stroke-width: 3;
  opacity: 1;
}

/* Cut highlight (red glow) */
.measurement-line[data-measure-type="cut"].is-hovered,
.measurement-line[data-measure-type="cut"].is-selected {
  stroke: var(--measure-cut-glow);
  filter: drop-shadow(0 0 4px var(--measure-cut-glow-soft));
}

/* Score/slit/perf highlight (purple glow) */
.measurement-line[data-measure-type="score-horizontal"].is-hovered,
.measurement-line[data-measure-type="score-horizontal"].is-selected,
.measurement-line[data-measure-type="score-vertical"].is-hovered,
.measurement-line[data-measure-type="score-vertical"].is-selected,
.measurement-line[data-measure-type="slit"].is-hovered,
.measurement-line[data-measure-type="slit"].is-selected,
.measurement-line[data-measure-type="perforation"].is-hovered,
.measurement-line[data-measure-type="perforation"].is-selected {
  stroke: var(--measure-score-glow);
  filter: drop-shadow(0 0 4px var(--measure-score-glow-soft));
}

.measurement-line[data-measure-type="hole"].is-hovered,
.measurement-line[data-measure-type="hole"].is-selected {
  stroke: var(--measure-hole-glow);
  filter: drop-shadow(0 0 4px var(--measure-hole-glow-soft));
}

/* =============================================
 * Preview Stage & Legend
 * ============================================= */
#svg .svg-line {
  stroke-linecap: round;
}

#svg .svg-sheet-outline {
  fill: none;
  stroke: #334155;
  stroke-width: 1.5;
}

#svg .svg-nonprintable-region {
  fill: rgba(249, 115, 22, 0.28);
  stroke: none;
}

#svg .svg-printable-outline {
  fill: none;
  stroke: #f97316;
  stroke-width: 1;
}

#svg .svg-layout-area {
  fill: none;
  stroke: #38bdf8;
  stroke-width: 1.5;
}

#svg .svg-document-area {
  fill: rgba(94, 234, 212, 0.18);
  stroke: #5eead4;
  stroke-width: 1;
}

#svg .svg-cut-line {
  stroke: #22d3ee;
  stroke-width: 1;
}

#svg .svg-slit-line {
  stroke: #facc15;
  stroke-width: 1;
}

#svg .svg-score-line {
  stroke: #a855f7;
  stroke-width: 1;
}

#svg .svg-perforation-line {
  stroke: #fb7185;
  stroke-width: 1;
  stroke-dasharray: 6 4;
}

#svg .svg-hole {
  fill: color-mix(in srgb, var(--measure-hole) 12%, transparent);
  stroke: var(--measure-hole);
  stroke-width: 1;
}

.sheet-preview-layout {
  display: flex;
  gap: 16px;
  align-items: stretch;
}
.sheet-preview-stage {
  background: var(--surface-panel-elevated);
  border: 1px solid var(--border-strong);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 360px;
  flex: 1;
}
.sheet-preview-container { --stack-gap: 8px; }

.layer-visibility-panel {
  background: var(--surface-panel-overlay);
  border: 1px solid var(--border-overlay);
  border-radius: 12px;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-width: 220px;
  max-width: 260px;
  box-shadow: 0 12px 24px var(--shadow-elevated);
}
.layer-visibility-panel .visualizer-visibility-toggles {
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: stretch;
}
.layer-visibility-option {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 10px;
  padding: 0;
  border: none;
  background: transparent;
  border-radius: 10px;
  cursor: pointer;
}
.layer-visibility-option .layer-visibility-label {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid var(--border-overlay);
  background: var(--surface-control);
  color: var(--text-muted);
  transition: border-color 0.2s ease, background 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
}
.layer-visibility-option .layer-visibility-label .legend-color-swatch { flex-shrink: 0; }
.layer-visibility-option:hover .layer-visibility-label {
  border-color: var(--border-highlight);
  background: var(--surface-control-hover);
  color: var(--text-secondary);
}
.layer-visibility-option input[type="checkbox"] {
  appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 6px;
  border: 1px solid var(--border-overlay);
  background: var(--surface-control);
  display: grid;
  place-items: center;
  transition: background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
  cursor: pointer;
}
.layer-visibility-option input[type="checkbox"]::after {
  content: "";
  width: 8px;
  height: 12px;
  border: 2px solid var(--surface-panel);
  border-top: 0;
  border-left: 0;
  transform: rotate(45deg) scale(0);
  transform-origin: center;
  transition: transform 0.18s ease;
}
.layer-visibility-option input[type="checkbox"]:focus-visible {
  outline: 2px solid var(--accent-primary);
  outline-offset: 2px;
}
.layer-visibility-option input[type="checkbox"]:checked {
  background: var(--accent-primary);
  border-color: var(--accent-primary);
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--accent-primary) 45%, transparent);
}
.layer-visibility-option input[type="checkbox"]:checked::after { transform: rotate(45deg) scale(1); }
.layer-visibility-option input[type="checkbox"]:checked + .layer-visibility-label {
  border-color: color-mix(in srgb, var(--accent-primary) 60%, var(--border-overlay));
  background: color-mix(in srgb, var(--accent-primary) 16%, var(--surface-control));
  color: var(--text-primary);
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--accent-primary) 35%, transparent);
}
.layer-visibility-option input[type="checkbox"]:checked + .layer-visibility-label span { color: inherit; }

/* Legend */
.sheet-preview-legend {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  font-size: 0.9rem;
  margin-top: 8px;
  color: var(--text-secondary);
}
.legend-color-swatch {
  display: inline-block;
  width: 12px;
  height: 12px;
  border-radius: 3px;
  margin-right: 6px;
}
.legend-swatch-layout-area     { background: var(--measure-layout); }
.legend-swatch-documents       { background: var(--measure-document); }
.legend-swatch-non-printable   { background: var(--measure-margin); }
.legend-swatch-cuts            { background: var(--measure-cut); }
/* Slits and perforations use SCORE channel (simplified system) */
.legend-swatch-slits,
.legend-swatch-perforations    { background: var(--measure-score); }
.legend-swatch-scores          { background: var(--measure-score); }
.legend-swatch-holes           { background: var(--measure-hole); }

/* =============================================
 * Print Styles
 * ---------------------------------------------
 * Hide interactive-only UI. Relax chrome.
 * ============================================= */
@media print {
  body { background: var(--surface-paper); color: var(--text-inverse); }
  .print-hidden { display: none !important; }
  .print-only-content { display: block !important; }
  .content-section { border: none; box-shadow: none; }
  .layout-app-shell { max-width: none; }
}
/* Keep print-only containers hidden on screen */
.print-only-content { display: none; }

/* =============================================
 * Motion Preferences
 * ---------------------------------------------
 * Respect reduced-motion users.
 * ============================================= */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
    scroll-behavior: auto !important;
  }
}

/* =============================================
 * Print Tab — Actual Size Visualizer
 * ============================================= */
.print-layout-grid {
  gap: 18px;
}

@media (min-width: 960px) {
  .print-layout-grid {
    grid-template-columns: minmax(280px, 340px) minmax(0, 1fr);
  }
}

.print-controls-card {
  gap: 18px;
}

.print-summary-grid {
  margin: 0;
  display: grid;
  gap: 12px;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.print-summary-grid dt {
  margin: 0;
  font-size: 0.85rem;
  font-weight: 600;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: var(--text-secondary);
}

.print-summary-grid dd {
  margin: 2px 0 0;
  font-variant-numeric: tabular-nums;
  color: var(--text-primary);
}

.print-layer-selector {
  border: 1px solid var(--border-default);
  border-radius: 10px;
  padding: 12px;
  display: grid;
  gap: 12px;
}

.print-layer-selector legend {
  padding: 0 6px;
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.print-layer-options {
  display: grid;
  gap: 8px;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.print-layer-option {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 10px;
  border: 1px solid var(--border-default);
  border-radius: 8px;
  background: var(--surface-overlay);
  color: var(--text-secondary);
  cursor: pointer;
  transition: border-color 0.2s ease, color 0.2s ease, background-color 0.2s ease;
}

.print-layer-option:hover {
  border-color: var(--border-highlight);
  color: var(--text-primary);
}

.print-layer-option input[type='checkbox'] {
  margin: 0;
  accent-color: var(--accent-primary);
}

.print-actions {
  display: grid;
  gap: 12px;
}

.print-action-row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.print-actions-hint {
  margin: 0;
  font-size: 0.85rem;
}

.print-preview-card {
  gap: 16px;
}

.print-preview-stage {
  position: relative;
  border: 1px solid var(--border-default);
  border-radius: 12px;
  background: var(--surface-overlay);
  min-height: 280px;
  padding: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: auto;
}

.print-preview-sheet {
  background: var(--surface-paper);
  color: var(--text-inverse);
  box-shadow: 0 0 0 1px var(--border-default), 0 24px 48px -32px var(--shadow-deep);
  padding: 12px;
}

.print-preview-empty {
  max-width: 360px;
  text-align: center;
  color: var(--text-secondary);
  display: grid;
  gap: 6px;
}

.print-preview-stage svg {
  display: block;
}

.print-preview-stage svg .svg-line {
  stroke-linecap: round;
}

.print-preview-stage svg .svg-sheet-outline {
  fill: none;
  stroke: #334155;
  stroke-width: 1.5;
}

.print-preview-stage svg .svg-nonprintable-region {
  fill: rgba(249, 115, 22, 0.28);
  stroke: none;
}

.print-preview-stage svg .svg-printable-outline {
  fill: none;
  stroke: #f97316;
  stroke-width: 1;
}

.print-preview-stage svg .svg-layout-area {
  fill: none;
  stroke: #38bdf8;
  stroke-width: 1.5;
}

.print-preview-stage svg .svg-document-area {
  fill: rgba(94, 234, 212, 0.18);
  stroke: #5eead4;
  stroke-width: 1;
}

.print-preview-stage svg .svg-cut-line {
  stroke: #22d3ee;
  stroke-width: 1;
}

.print-preview-stage svg .svg-slit-line {
  stroke: #facc15;
  stroke-width: 1;
}

.print-preview-stage svg .svg-score-line {
  stroke: #a855f7;
  stroke-width: 1;
}

.print-preview-stage svg .svg-perforation-line {
  stroke: #fb7185;
  stroke-width: 1;
  stroke-dasharray: 6 4;
}

.print-preview-stage svg .svg-hole {
  fill: color-mix(in srgb, var(--measure-hole) 12%, transparent);
  stroke: var(--measure-hole);
  stroke-width: 1;
}
